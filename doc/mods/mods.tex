\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{algpseudocode}
\usepackage{algorithm}

\begin{document}


\begin{algorithm}
\caption{{\bf Searching with Modifications} Inputs: (1) a charged
  spectrum S containing a mass and a list of peaks, (2) a set Q of
  sequences each containing a mass and an ordered list of amino acids,
  (3) a set M of peptide modifications, (4) the number N of PSMs to
  output per spectrum. Outputs: a set R of PSMs.  Each PSM contains a
  peptide sequence (q) and two scores (x, sp).}

\begin{algorithmic}[1]
\Procedure{SearchOneSpectrum}{S, Q, M, N}

\State R $\gets$ []
\Comment Initialize an empty set of results.

\For{i $\gets$ 1 ... $|$M$|$}
   \State Qs $\gets$ selectPeptidesInMassRange(S.mass, M[i], Q)
   
   \For{j $\gets$ 1 ... $|$Qs$|$}
     \State r $\gets$ newPsm(Qs[j])
     \Comment Create new PSM and set sequence.
     \State r.sp $\gets$ scorePeptideSp(r.q, S.peaks)
     \Comment Set Sp score for PSM.
     \State R += r
     \Comment Add PSM to set of results.
   \EndFor

   \State R $\gets$ sortBySp(R)
   \State R $\gets$ truncateTopN(R, 500)
   \Comment Keep only best-scoring PSMs for xcorr scoring.

   \For{j $\gets$ 1 ... $|$R$|$}
     \State R[j].x $\gets$ scorePeptideXcorr(R[j].q, S.peaks)
   \EndFor

   \State R $\gets$ sortByXcorr(R)
   \State R $\gets$ truncateTopN(R, N)
   \Comment Keep only N of the best PSMs.

\EndFor

\State \Return{R}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{ Inputs: the target mass (m), a peptide modification (Mx),
  and a set of possible sequences (Q).  Output: a set of modified
  peptides in the specified mass range.}

\begin{algorithmic}[1]
\Procedure{selectPeptidesInMassRange}{m, Mx, Q}
  \State Qu $\gets$ selectUnmodifiedPeptides(m - Mx.mass, Q)
   
  \State Qm $\gets$ []
  \Comment Initialize set of modified peptides.

  \For{i $\gets$ 1 ... n}
    \If{isModifiable(Qu[i], Mx)}
      \State Qm += generateAllModifiedForms(Qu[i], Mx)
    \EndIf
  \EndFor

  \State \Return{Qm}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\end{document}
