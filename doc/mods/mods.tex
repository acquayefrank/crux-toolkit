\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{algpseudocode}
\usepackage{algorithm}

\begin{document}


\begin{algorithm}
\caption{{\bf Searching with Modifications} Inputs: (1) a charged
  spectrum S containing a mass and a list of peaks, (2) a set Q of
  sequences each containing a mass and an ordered list of amino acids,
  and (3) a set M of peptide modifications. Outputs: a set R of PSMs.
  Each PSM contains a peptide sequence (q) and two scores (x, sp).} 

\begin{algorithmic}[1]
\Procedure{SearchOneSpectrum}{S, Q, M}

\State R $\gets$ []
\Comment Initialize an empty set of results.

\For{i $\gets$ 1...$|$M$|$}
   \State Qs $\gets$ selectPeptidesInMassRange(S.mass, M$_i$, Q)
   
   \For{j $\gets$ 1...$|$Qs$|$}
     \State r.q $\gets$ newPsm(Qs[j])
     \Comment Create new psm and set sequence.
     \State r.sp $\gets$ scorePeptideSp(r.q, S.peaks)
     \Comment Set Sp score for psm.
     \State R += r
     \Comment Add psm to set of results.
   \EndFor

   \State R $\gets$ sortBySp(R)
   \State R $\gets$ truncateTop500(R)
   \Comment Keep only best-scoring psms for xcorr scoring.

   \For{j $\gets$ 1...500}
     \State R[j].x $\gets$ scorePeptideXcorr(R[j].q, S.peaks)
   \EndFor

   \State R $\gets$ sortByXcorr(R)
   \State R $\gets$ truncateTopN(R)
   \Comment Keep only N of the best psms.

\EndFor

\State \Return{R}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{ Inputs: the target mass (m), a peptide modification (Mx),
  and a set of possible sequences (Q).  Output: a set of modified
  peptides in the specified mass range.}

\begin{algorithmic}[1]
\Procedure{selectPeptidesInMassRange}{m, Mx, Q}
  \State Qu $\gets$ selectUnmodifiedPeptides(m - Mx.mass, Q)
   
  \State Qm $\gets$ empty set of modified peptides

  \For{i $\gets$ 1...n}
    \If{isModifyable(Qu[i], Mx)}
      \State Qm += generateAllModifiedForms(Qu[i], Mx)
    \EndIf
  \EndFor

  \State \Return{Qm}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\end{document}
