\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{algpseudocode}
\usepackage{algorithm}

\begin{document}


\begin{algorithm}
\caption{{\bf Searching with Modifications} Inputs: (1) a charged
  spectrum s containing a mass and a list of peaks, (2) a set Q of
  sequences each containing a mass and an ordered list of aas, (3) a
  set A of amino acid modifications, each containing a mass shift m,
  list a of modifiable aas, and max occurrences x per peptide, and (4)
  a set M of peptide modifications.  Each peptide modification
  contains a set of amino acid modifications, represented as
  count\_a\_i for i in 0 to 10. It also has the number of amino acid
  modifications (sum over i count\_a\_i), and the total mass shift
  (sum over $i$ count\_a\_i * a\_i.mass). Outputs: a set of PSMs R.
  Each psm contains a peptide sequence (q), two scores (x, sp) and
  two ranks (rx, rsp).}

\begin{algorithmic}[1]
\Procedure{SearchOneSpectrum}{s, Q, A, M}

\State R $\gets$ []
\Comment Initialize an empty set of results.

\For{$i \gets 1 \dots |M|$}
   \State Qs $\gets$ selectPeptidesInMassRange(s.mass, M\_i, Q)

   \State Rt $\gets$ []
   \Comment Temporary results, this spectrum only.
   \For{j $\gets$ 1...m}
     \State Rt\_j.q $\gets$ newPsm(Qs\_j)
     \State Rt\_j.sp $\gets$ scorePeptideSp(Rt\_j.q, s.peaks)
   \EndFor

   \State R += Rt
   \State R $\gets$ sortBySp(R)
   \For{j $\gets$ 1...m}
     \State R\_j.rsp $\gets$ j
   \EndFor
   \State R $\gets$ truncateTop500(R)

   \For{j $\gets$ 1...500}
     \State R\_j.x $\gets$ scorePeptideXcorr(R\_j.q, s.peaks)
   \EndFor

   \State R $\gets$ sortByXcorr(R)
   \For{j $\gets$ 1...m}
     \State R\_j.rx $\gets$ j
   \EndFor

\EndFor

\State \Return{R}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{ Inputs: the target mass (m), a peptide modification (Mx),
  and a set of possible sequences (Q).  Output: a set of modified
  peptides in the specified mass range.}

\begin{algorithmic}[1]
\Procedure{selectPeptidesInMassRange}{m, Mx, Q}
  \State Qu $\gets$ selectUnmodifiedPeptides(m - Mx.mass, Q)
   
  \State Qm $\gets$ empty set of modified peptides

  \For{i $\gets$ 1...n}
    \If{isModifyable(Qu\_i, Mx)}
      \State Qm += generateAllModifiedForms(Qu\_i, Mx)
    \EndIf
  \EndFor

  \State \Return{Qm}
\EndProcedure
\end{algorithmic}
\end{algorithm}

\end{document}
