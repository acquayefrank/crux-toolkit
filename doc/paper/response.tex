\documentclass{article}
\usepackage[margin=1in]{geometry}
\usepackage[dvips]{color}
\usepackage{url}

\newcommand{\breview}{\begin{quotation}\begin{em}\noindent}
\newcommand{\ereview}{\end{em}\end{quotation}}

\begin{document}

\hspace*{3.0in}\today

\vspace*{3ex}

\noindent
Dear editor:

\vspace*{1ex}

We are submitting a revised version of the manuscript ``Rapid and
accurate peptide identification from tandem mass spectra,'' in which
we attempt to address all of the reviewers' concerns.  Our detailed
responses are given below.

We hope that the revised version is suitable for publication in {\em
Journal of Proteome Research}.

\vspace*{1ex}

\noindent
Sincerely,

\hspace*{1ex}

\noindent
William Stafford Noble\\
Department of Genome Sciences\\
University of Washington


\section*{Reviewer \#1}

\breview The authors note that they are aware that SEQUEST has
implemented indexed database searching, likely approaching 10 years
ago now, yet this manuscript fails to include that version in the
analysis shown in Figure 2.  It is hard to believe that the authors do
not have access or can easily get access to a version of SEQUEST (aka
TurboSEQUEST) that supports indexed database searching.  Leaving out
that version in the analysis presented in Figure 2 and then making
claims of x-fold increase in speed is completely irresponsible of the
authors. \ereview

We obtained a copy of TurboSEQUEST, and we have included a timing
comparison in the revised version of the manuscript. {\em
FIXME[Aaron]: Summarize results here.}

\breview Regarding the reimplementation of Sp and Xcorr, the authors
show scatter plots in Figure 3 where Sp is very close to the ideal
diagonal but Xcorr shows some spread.  The authors mention that they
modified SEQUEST source code for the performance comparisons.  How
does having access to the SEQUEST source code manifest itself in what
appears to be a very good reimplementation of Sp but a less than ideal
reimplementation of Xcorr? \ereview

We do have access to the SEQUEST source code; however, to avoid risks
of copyright infringement, none of the individuals working directly
with the source code of Crux has read permission on those files.
Instead, to generate the Sp and Xcorr functions in Crux, I added print
statements to SEQUEST.  The Crux programmers then used the detailed
output from this modified version of the program to reverse engineer
the underlying functions.  This is a lengthy process.  Once we
achieved the level of agreement shown in the manuscript, we stopped.

In the revised manuscript, we have removed the comparison to a
modified form of SEQUEST, in response to a comment from Reviewer \#2.

\breview The rest of the manuscript touches on other components of the
software that are either not novel or are previously published.  This
is evidence by the lack of details in the rest of the Results section
(2.3 and 2.4).  \ereview

FIXME[Bill]

\breview On-the-fly decoy database generation is a nice feature to
have but is not a feature that can be considered novel or cutting
edge. \ereview

FIXME[Bill]

\breview The last paragraph in the Discussion mentions that Crux is
still under development.  Specifically ``improved support for searches
that allow differential modifications'' implies that either Crux
currently poorly supports differential modifications or does not
support that feature at all now.  If the latter is the case, it is
practically useless in its current form and this manuscript is
premature. \ereview

FIXME[Aaron]

\breview One major selling point of this manuscript is to describe the
availability of a freely available (to academics) reimplementation of
SEQUEST, including source code.  Many members of the proteomics
research community would welcome such a tool if Crux actually fulfills
that promise.  Given this context in order to properly review this
manuscript, the Crux program (source files) needs to be made available
to the reviewers. \ereview

We are attaching the Crux source code with this version of the
manuscript.  Please note that in our initial letter to the editor, we
did offer to make the source code available to the reviewers.

\breview The format of the manuscript does not conform to those
typically published in JPR.  For example, the authors list is not
formatted as instructed.  The keywords are missing.  The Materials and
Methods section appear after the Results and Discussion.  Sections and
subsection have numerical designations that are not used in
JPR. \ereview

The manuscript was formatted using the LaTeX style file provided by
{\em Journal of Proteome Research} at \url{FIXME}.  We submitted
keywords via the {\em JPR} website, but have also inserted them on the
title page of the revised manuscript.

\breview And finally significant portions of this manuscript lack
substance as evidenced by short paragraphs quickly describing
previously published or submitted tools.  The manuscript needs to be
reorganized and rewritten to highlight the truly novel aspects of
research that the authors want to convey. \ereview

FIXME[Bill]

\section*{Reviewer \#2}

\breview The abstract describes Crux as pushing the state of the art
for peptide identification, but it's unclear which of its features are
``novel'' and justify such a strong claim. The authors note that
``peptide indexing'' has been added to TurboSEQUEST, and other search
engines (notably X! Tandem) also use strategies to minimize the time
it takes to retrieve candidate peptides. Similarly, X! Tandem has for
some time been able to generate decoy sequences on the fly (via the
``scoring, include reverse'' parameter). The Percolator algorithm has
been previously published and the Weibull estimate has been submitted
for publication (and may be related to the extreme value distribution
used to approximate the negative distribution in current
PeptideProphet releases?). The integration of all these features in a
single package is certainly a strong point, but it's not clear that
integration itself changes the state of the art. The rhetoric could be
toned down or better supported. \ereview

FIXME[Bill]

\breview The most clear and important contribution of the Crux paper
is that it promises a SEQUEST implementation ``free for academic
use''. What is the mechanism by which this will be distributed? It is
not currently available from the supplied Noble Lab URL. For a
manuscript that primarily describes a software package and properties
of its implementation (its efficiency, its ``object oriented'' design,
etc.), isn't it reasonable for a reviewer to expect to see the code?
Access to other packages from the Noble and MacCoss Labs is routed
through UW Tech Transfer. Have they approved the proposed
non-commercial distribution for Crux? For binaries, source code, or
both forms? Is distribution automatic based on acceptance of the UW
licensing terms? Does it require contacting a Tech Transfer officer?
Is the request approved or denied based on review of supplied licensee
contact information? The specific mechanisms for non-commercial
access, to both source and binary, need to be spelled out. If
non-commercial access is to be in any way at the institution's
discretion, this needs to be explicitly stated. \ereview

We have submitted a copy of the Crux source code along with our
revised manuscript.  Crux will be made available as compiled binaries
and source code.  It will be free for academic use and will be
available for licensing via UW tech transfer.  The licensing mechanism
will be identical to that currently in place for Percolator, involving
a click-through license for non-academic use.  This has been approved
by our tech transfer office.

Please note that, in the letter to the editor that accompanied our
initial submission, we did offer to make the source code available to
the reviewers and to provide a letter from our tech transfer office
indicating their approval of our plans to make Crux available as
source code free for non-commercial use.

\breview The authors claim, on page 4, that ``Crux is both efficient
and accurate.'' But it is hard to gauge the performance of Crux from
the supplied examples. Figure 2 uses a version that computes on the Sp
score and compares peptide indexing favorably to a version of SEQUEST
that also computes only the Sp score but lacks peptide
indexing. Looking at the speed of Crux without peptide indexing,
however, we see that it's some 10X *slower* than SEQUEST. If peptide
indexing were added to SEQUEST (as in the TurboSEQUEST implementation
that the authors exclude from consideration!) would it be 10X faster
than the optimized Crux? \ereview

To address this concern, and the concern of Reviewer \#1, we obtained
a copy of TurboSEQUEST and included it in the comparison. {\em
FIXME[Aaron]: Summarize results in one sentence here.}

\breview It's a little bizarre to do timing comparisons on versions of
the code with Xcorr removed. One rationale for this might be that the
``Sp score only'' comparison of Figure 2 is intended to focus only on
the relative gains from peptide indexing, but the reader might also
suspect that Xcorr is excluded because the Crux implementation is even
slower than that in SEQUEST. There are a number of ways to compute
Xcorr (FFTs, naive brute-force convolution) and any defense of
efficiency should address this and provide some metrics. \ereview

Our motivation for removing the XCorr component of SEQUEST was indeed
to isolate the effect of indexing on speed.  However, we agree with
the reviewer that comparing unmodified code is more convincing.
Therefore, in the revised version of the manuscript, the comparisons
are done using Xcorr. {\em FIXME[Aaron]: Summarize results in one
sentence here.}

\breview As to accuracy, it would be interesting to know why, if Crux
reimplements SEQUEST faithfully, there is variation in Xcorr as
illustrated in Figure 3. The authors assert that the comparison is
favorable, but this is a single dataset from a single instrument (an
LTQ?). It would be interesting to know what happens to the Xcorr
comparison when considering data from, say, a QTOF or
MALDI-TOF/TOF. \ereview

{\em FIXME[Aaron]: Can we do this easily?}

\breview Some more information on the methods is needed. What kind of
instrument was used to gather the yeast data? It's impossible to tell
from the referenced URL for the 60cm data since the files don't seem
to be available. \ereview

We apologize---we inadvertently unzipped the files on the website,
which caused the URLs to break.  This has been fixed.  We have added a
few more details about the data set to the manuscript: FIXME[Aaron].
Additional details are available in the referenced manuscript, where
this data was first used.

\breview In Figure 2, the text talks about searching a collection of
1000 spectra but the legend indicates ``runtime for 100
spectra''. \ereview

This was a typo, which has been fixed.  The figure legend was correct.

\end{document}
