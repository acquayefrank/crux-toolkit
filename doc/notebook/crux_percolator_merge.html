<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OOo-dev 2.0  (Linux)">
	<META NAME="CREATED" CONTENT="20070611;14101900">
	<META NAME="CHANGED" CONTENT="20070612;10315200">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin: 0.79in }
		P { margin-bottom: 0.08in }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P STYLE="margin-bottom: 0in"><BR>
</P>
<HR>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">Percolator
incorporation plan</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<HR>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">Percolator
feature generation.</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">Divided
the features into spectrum and match specific features stored in the
following structs.</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">struct
match_collection{</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">MATCH_T*
match[_MAX_NUMBER_PEPTIDES]; ///&lt; array of match object</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">BOOLEAN_T
scored_type[_SCORE_TYPE_NUM]; ///&lt; has the score type been
computed in each match</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">int match_total;
///&lt; total_match_count</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">Spectrum_features_t*
features &lt;----------------  </FONT></FONT></B><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">Spectrum
specific features</FONT></FONT></B></CODE></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">}</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">struct
match{</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">SPECTRUM_T*
spectrum; ///&lt; the spectrum we are scoring with</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">PEPTIDE_T* peptide; 
///&lt; the peptide we are scoring</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">float
match_scores[_SCORE_TYPE_NUM]; ///&lt; the scoring result array (use
enum_type SCORER_TYPE_T to index)</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">int
match_rank[_SCORE_TYPE_NUM];  ///&lt; the rank of scoring result (use
enum_type SCORER_TYPE_T to index)</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
 <B><FONT SIZE=3><FONT FACE="Courier, monospace">Match</FONT></FONT></SPAN></B><CODE><SPAN STYLE="text-decoration: none"><B><FONT SIZE=3><FONT FACE="Courier, monospace">_features_t*
features &lt;----------------  </FONT></FONT></B><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">Match
specific features</FONT></FONT></B></CODE></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">}</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">When
time to register PSMs, use &ldquo;</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">get_percolator_features&rdquo;
method that takes a match and its match_collection as </FONT></FONT></SPAN></B></CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">arguments
and returns a float array in the Percolator input format.</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">float*
get_percolator_features(</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT FACE="Courier, monospace"><FONT SIZE=3>	</FONT><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">MATCH_T*
match</FONT></FONT></SPAN></CODE><FONT SIZE=3>	,</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT FACE="Courier, monospace"><FONT SIZE=3>	</FONT><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">Match_collection_t*
</FONT></FONT></SPAN></CODE></FONT></SPAN></B><CODE><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection</FONT></FONT></SPAN></B></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	)</FONT></FONT></SPAN></B></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT SIZE=3>Percolator features,</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">1.
Match specific features:</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">	Xcorr,
Sp, ln(rSp), Mass, <FONT FACE="Bitstream Vera Sans, sans-serif">&#8710;</FONT></FONT></FONT></B><CODE><B><FONT FACE="Courier, monospace"><FONT SIZE=3>Mass:(observed
- calculated), abs(</FONT><CODE><FONT SIZE=3><FONT FACE="Bitstream Vera Sans, sans-serif">&#8710;</FONT></FONT></CODE></FONT></B><CODE><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">Mass),
Fraction of b&amp;y ion match, </FONT></FONT></B></CODE></CODE></CODE></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">	enzN:N-term
tryptic?, enzC:C-term tryptic?, enzInt:number of missed cleavage
sites, </FONT></FONT></B></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">	charge1~3:
charge state</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">2.
Spectrum specific features:</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><B><FONT SIZE=3><FONT FACE="Bitstream Vera Sans, sans-serif">	&#8710;</FONT></FONT></B></CODE><B><FONT FACE="Courier, monospace"><FONT SIZE=3>Cn,
</FONT><CODE><FONT SIZE=3><FONT FACE="Bitstream Vera Sans, sans-serif">&#8710;</FONT></FONT></CODE><FONT SIZE=3>Cln,
ln(NumSp):log of number peptide in mass range</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">3.
Intra-spectra specific features:</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3><FONT FACE="Courier, monospace">	ln(numPep),
ln(numProt), ln(pepSite)</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">/***************</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
<B><FONT SIZE=3><FONT FACE="Courier, monospace">* pseudo-code</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">
<B><FONT SIZE=3><FONT FACE="Courier, monospace">***************/</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">//top_match_collection
will store all top ranked PSMs</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">Match_collection_t*
top_</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection
= new_match_collection();</FONT></FONT></SPAN></B></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">Match_collection_t*
</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection;</FONT></FONT></SPAN></B></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">int
keep_top_rank = 5</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">foreach
spectrum:</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	//generates
a match_collection from the spectrum </FONT></FONT></SPAN></B></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection
= new_</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection(spectrum);</FONT></FONT></SPAN></B></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	foreach
top_match in match_collection upto keep_top_rank:</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">		//Register
PSM with features to Percolator</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">		pcRegisterPSM(get_sequence(top_match),
get_percolator_features(top_match, match_collection))</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	//transfers
the #top rank matches to top_match_collection</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT FACE="Courier, monospace"><FONT SIZE=3>	transfer_match(</FONT><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">top_</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection,
</FONT></FONT></SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection,
</FONT></FONT></SPAN></CODE></FONT></SPAN></B><CODE><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">keep_top_rank);</FONT></FONT></SPAN></B></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	</FONT></FONT></SPAN></B></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">//free
match_collection</FONT></FONT></SPAN></B></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">	free(</FONT></FONT></SPAN></B><CODE><B><SPAN STYLE="text-decoration: none"><FONT SIZE=3><FONT FACE="Courier, monospace">match_collection)</FONT></FONT></SPAN></B></CODE></CODE></P>
<HR>
<P><BR><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
</BODY>
</HTML>