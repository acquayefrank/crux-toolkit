                     
Benchmark
                      </font></b></code>
                      <br><br>
<hr>
                      <br><code><b><font face="Helvetica, monospace">
              Jan 12, 2006
                </font></b></code>

                <br><br><code><b><font face="Helvetica, monospace">
Purpose:
                </font></b></code><br><br>
                To determine the difference in speed between seeking in a
                file and memory mapping the file.

                <br><br><code><b><font face="Helvetica, monospace">
Methods:
                </font></b></code><br><br>
                Run run.sh in crux/benchmark/test-mmap. This runs two c
                executables, test (which uses the memory mapped file) 
                and test-seek (which uses lseek), using various 
                sizes of database and various numbers accesses, on two
                different fasta files, nrdb and ecoli. The accesses are
                randomly scattered throughout the file, with a maximum of
                'bytes accessed'. Real time is akin to wall clock time.
                CPU time is user + kernel time (the sum of the second 
                two fields from the command time).
                <br><br>

 
<code><b><font face="Helvetica, monospace">
Results:
                </font></b></code><br><br>
Random access
<br>
<br>
<table border=1>
<thead> <tr valign=top> 
    <th> <p align=center>Proteome</p>
		</th>
    <th> <p align=center>Bytes accessed (MB)</p>
		</th>
    <th> <p align=center>Number of accesses</p>
		</th>
    <th> <p align=center>Real time - mmap</p>
		</th>
    <th> <p align=center>CPU time - mmap</p>
		</th>
    <th> <p align=center>Real time - lseek</p>
		</th>
    <th> <p align=center>CPU time - lseek</p>
		</th>

	</thead>
    <tr>
    <td>
      <p align=center>
      Human
      </p>
	  </td>
    <td>
      <p align=center>
      16
      </p>
	  </td>

    <td>
      <p align=center>
      10 million
      </p>
	  </td>
    <td>
      <p align=center>
      3.058s
      </p>
	  </td>
    <td>
      <p align=center>
      3.020s
      </p>
	  </td>
    <td>
      <p align=center>
      19.100s
      </p>
	  </td>
    <td>
      <p align=center>
      19.050s
      </p>
	  </td>
    </tr>
    <tr>
    <td>
      <p align=center>
     NRdb 
      </p>
	  </td>
    <td>
      <p align=center>
      1600
      </p>
	  </td>

    <td>
      <p align=center>
      10 million
      </p>
	  </td>
    <td>
      <p align=center>
      6.386s
      </p>
	  </td>
    <td>
      <p align=center>
      6.250s
      </p>
	  </td>
    <td>
      <p align=center>
      17m28.320s
      </p>
	  </td>
    <td>
      <p align=center>
      25.870s
      </p>
	  </td>
    </tr>



</table>
<br>
Serial access
<br>
<br>
<table border=1>
<thead> <tr valign=top> 
    <th> <p align=center>Proteome</p>
		</th>
    <th> <p align=center>Bytes accessed (MB)</p>
		</th>
    <th> <p align=center>Number of accesses</p>
		</th>
    <th> <p align=center>Real time - mmap</p>
		</th>
    <th> <p align=center>CPU time - mmap</p>
		</th>
    <th> <p align=center>Real time - lseek</p>
		</th>
    <th> <p align=center>CPU time - lseek</p>
		</th>

	</thead>
    <tr>
    <td>
      <p align=center>
      Human
      </p>
	  </td>
    <td>
      <p align=center>
      16
      </p>
	  </td>

    <td>
      <p align=center>
      10 million
      </p>
	  </td>
    <td>
      <p align=center>
      0.607s
      </p>
	  </td>
    <td>
      <p align=center>
      0.570s
      </p>
	  </td>
    <td>
      <p align=center>
      12.958s
      </p>
	  </td>
    <td>
      <p align=center>
      12.530s
      </p>
	  </td>
    </tr>
    <tr>
    <td>
      <p align=center>
     NRdb 
      </p>
	  </td>
    <td>
      <p align=center>
      1600
      </p>
	  </td>
    <td>
      <p align=center>
      10 million
      </p>
	  </td>
    <td>
      <p align=center>
      3.475s
      </p>
	  </td>
    <td>
      <p align=center>
      3.300s
      </p>
	  </td>
    <td>
      <p align=center>
      16.019s
      </p>
	  </td>
    <td>
      <p align=center>
      15.430s
      </p>
	  </td>
    </tr>

</table>



<br><code><b><font face="Helvetica, monospace">
      Discussion:
                </font></b></code><br><br>
                Memory mapping looks clearly superior to lseek when using
                random access, as expected. Unexpectedly (for me), using the memory 
                map is faster with serial access as well.

                It does look like (from data not shown, but created by the
                scripts) that if the number of page accesses is less than
                the number of pages, and the number of pages is greater
                than the maximum number of pages available for memory,
                then seeking is better than memory mapping for serial (but
                not random) access. Otherwise memory mapping is better.
                This makes sense,
                because there is some overhead to memmapping, and if you
                don't get a chance to use the same page more than once,
                then why bother with paging?

 <hr>
                      <br><code><b><font face="Helvetica, monospace">
              Aug 21, 2006
                </font></b></code>

                <br><br><code><b><font face="Helvetica, monospace">
Purpose:
                </font></b></code><br><br>
                To examine size of indexed databases on disk.

                <br><br><code><b><font face="Helvetica, monospace">
Methods:
                </font></b></code><br><br>
                Run create_index on ecoli+contam.fasta, and examine the
                relative size of the fasta file to the index, using unique
                and all peptides (no enzyme specificity). Use this to
                extrapolate for larger fasta files. This is done with ASCII
                files, with whitespace and peptide delimiters.
                <br><br>

                <br><br>
 
<br><br><code><b><font face="Helvetica, monospace">
Results:
                </font></b></code><br><br>
<table border=1>
<thead> <tr valign=top> 
    <th> <p align=center>Proteome</p>
		</th>
    <th> <p align=center>Extrapolated</p>
		</th>
    <th> <p align=center>Fasta Size (GB)</p>
		</th>
    <th> <p align=center>Index Size (GB)</p>
		</th>
    <th>
	</thead>
    <tr>
    <td>
      <p align=center>
      E. coli
      </p>
	  </td>
    <td>
      <p align=center>
      N
      </p>
	  </td>
    <td>
      <p align=center>
      0.00162
      </p>
	  </td>
    <td>
      <p align=center>
      0.314
      </p>
	  </td>
    </tr>

    <tr>
    <td>
      <p align=center>
      Human
      </p>
	  </td>
    <td>
      <p align=center>
      Y
      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    </tr>

    <tr>
    <td>
      <p align=center>
      MSDB
      </p>
	  </td>
    <td>
      <p align=center>
      Y
      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    </tr>

    <tr>
    <td>
      <p align=center>
      NrDB
      </p>
	  </td>
    <td>
      <p align=center>
      Y
      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    </tr>
</table>

<br><br>
<hr>
                      <br><code><b><font face="Helvetica, monospace">
              Aug 11, 2006
                </font></b></code>

                <br><br><code><b><font face="Helvetica, monospace">
Purpose:
                </font></b></code><br><br>
                To compare the speed of generatePeptides.py and
                generate_peptides both with and without indexing.

                <br><br><code><b><font face="Helvetica, monospace">
Methods:
                </font></b></code><br><br>
                Time the following two commands:
                <br><br>

                <br><br>
 
<br><br><code><b><font face="Helvetica, monospace">
Results:
                </font></b></code><br><br>
<table border=1>
<thead> <tr valign=top> 
    <th> <p align=center>Algorithm</p>
		</th>
    <th> <p align=center>Database</p>
		</th>
    <th> <p align=center>Time (s)</p>
		</th>
    <th>
	</thead>
    <tr>
    <td>
      <p align=center>

      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    <td>
      <p align=center>

      </p>
	  </td>
    </tr>
</table>
<br><br>
<hr>
</html>
