<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OOo-dev 2.0  (Linux)">
	<META NAME="CREATED" CONTENT="20070611;14101900">
	<META NAME="CHANGED" CONTENT="20070706;15263900">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin: 0.79in }
		P { margin-bottom: 0.08in }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P STYLE="margin-bottom: 0in"><BR>
</P>
<HR>
<P STYLE="margin-bottom: 0in"><CODE><B><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">Percolator
incorporation plan</FONT></FONT></B></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<HR>
<P STYLE="margin-bottom: 0in"><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">The
database search and Percolator interface are decoupled by
'match_search' and 'match_analysis'.</FONT></FONT></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">'match_search'
performs a database search for each spectra then outputs the result
in <CODE><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">a
serialized binary file format and </FONT></FONT></CODE>an optional
human-readable format(sqt). 'match_analysis' will read in the
serialized binary output files from 'match_search' and generate run
specific features that can be passed over to Percolator.</FONT></FONT></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">To
keep track of PSM identifications from the binary output file, two
new objects are created. First, rich_match_collection and second
rich_match. rich_match_collection is an extension of match_collection
but is instantiated by the binary output files. Similarly, rich_match
is an extension of match object. The </FONT></FONT><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match_collection
and rich_match objects will together provide the functionality to
generate run specific features.</FONT></FONT></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Serialize
the match and spectrum features of the PSM</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">void
serialize_psm_features(</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">FILE*
output, //&lt; PSM database output file</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">int
output_rank, ///&lt; the top peptides to be serialized.</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">MATCH_COLLECTION_T*
match_collection </FONT></FONT></SPAN><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//&lt;
match_collection features to be serialized</FONT></FONT></SPAN></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">)
</FONT></FONT></SPAN></CODE>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Header</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
number of spectra&gt;</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
number spectrum features&gt;</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
number of top rank peptide&gt;</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
ms2 file length&gt;&lt;char[*]: ms2 file name&gt;</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
auxiliary feature count&gt;&lt;float: <CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">auxiliary
</FONT></FONT></SPAN></CODE>features&gt;* </FONT></FONT></SPAN></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;int:
database file length&gt;</FONT></FONT></SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;char[*]:
database filename&gt;</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">[parameter
file]</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Serialization
format per spectrum matches</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">[serialize
spectrum][spectrum specific features]</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">{[match
score &amp; rank][serialize peptide</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">]}*</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">parameter
file = </FONT></FONT></SPAN></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">serialize
spectrum = &lt;int: first_scan&gt;&lt;int: last_scan&gt;&lt;int:
id&gt;&lt;float: precursor_mz&gt;<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">&lt;float:
retention_time&gt;</FONT></FONT></SPAN></CODE>&lt;int:
num_possible_z&gt;&lt;int: possible_z&gt;*</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">spectrum
specific features = &lt;float: </FONT></FONT></SPAN></CODE>&#8710;</CODE><FONT FACE="Courier, monospace"><FONT SIZE=3 STYLE="font-size: 13pt">Cn&gt;&lt;float:
</FONT><CODE>&#8710;</CODE><FONT SIZE=3 STYLE="font-size: 13pt">Cln&gt;&lt;float:
ln(NumSp)&gt;</FONT></FONT></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match
score &amp; rank = [&lt;</FONT></FONT></SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">int:
match_score&gt;&lt;int: rank&gt;]*</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">serialize
peptide = &lt;PEPTIDE_T: peptide struct&gt;&lt;int: number of
peptide_src&gt;[&lt;int: protein index&gt;&lt;PEPTIDE_TYPE_T:
peptide_type&gt;&lt;int: peptide start index&gt;]+</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">/***************</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;</SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">*
match_search.c</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;</SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">***************/</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">MATCH_COLLECTION_T*
</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match_collection;</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">int
output_top_rank = 5 </FONT></FONT></SPAN></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">FILE*
output_sqt;</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">FILE*
output_file = get_output_file(p</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">sm_result_folder);</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">foreach
spectrum:</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//generates
a match_collection from the spectrum </FONT></FONT></SPAN></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match_collection
= new_</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match_collection(spectrum);</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//serialize
the PSM's match &amp; spectrum features to output file up to
output_top_rank </FONT></FONT></SPAN></CODE></CODE>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">serialize_psm_features(<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">output_file</FONT></FONT></SPAN></CODE>,
output_top_rank, </FONT></FONT></SPAN><CODE><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match_collection);</FONT></FONT></SPAN></CODE></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Also
output PSMs in sqt file</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">print_match_collection_sqt(output_sqt,
top_match, match_collection);</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//free
match_collection</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">free(</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">match_collection)</FONT></FONT></SPAN></CODE></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">/******************</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;</SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">*
match_analysis.c</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;</SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">*******************/</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//create
<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">RICH_MATCH_COLLECTION_T</FONT></FONT></SPAN></CODE>
object and read in the output PSM results.</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">RICH_MATCH_COLLECTION_T*
<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match_collection
= </FONT></FONT></SPAN></CODE>new_rich_match_collection(psm_result_folder);</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Process
PSM output and generate the run specific features</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">process_run_specific_features(<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match_collection</FONT></FONT></SPAN></CODE>);</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//create
iterator, to register each PSM feature to Percolator</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">RICH_MATCH_ITERATOR_T*
rich_match_iterator = new_rich_match_iterator(rich_match_collection</FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">);</FONT></FONT></SPAN></CODE></FONT></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><CODE><FONT SIZE=3 STYLE="font-size: 13pt"><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">foreach
rich_match in </FONT></FONT></SPAN><CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match_iterator:</FONT></FONT></SPAN></CODE></FONT></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;</SPAN></CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">//Register
PSM with features to Percolator</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><CODE><SPAN STYLE="text-decoration: none">&nbsp;&nbsp;&nbsp;<FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">pcRegisterPSM(get_<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match_</FONT></FONT></SPAN></CODE>sequence(<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match</FONT></FONT></SPAN></CODE>),
get_rich_match_percolator_features(<CODE><SPAN STYLE="text-decoration: none"><FONT SIZE=3 STYLE="font-size: 13pt"><FONT FACE="Courier, monospace">rich_match</FONT></FONT></SPAN></CODE>));</FONT></FONT></SPAN></CODE></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<HR>
<P><BR><BR>
</P>
</BODY>
</HTML>