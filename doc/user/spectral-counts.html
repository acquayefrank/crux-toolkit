<html>
<head>
<title>crux spectral-counts</title>
<link href="./crux.css" rel="styleSheet" type="text/css">
</head>
<body>
<blockquote>
<h1 align="center">crux spectral-counts</h1>
<p>
<b>Usage:</b></p>
<blockquote>
<code>crux spectral-counts [options] &lt;input
  PSMs&gt;&nbsp;&lt;protein database&gt;</code>
</blockquote>
<p>
<b>Description:</b></p>
<blockquote>
<p>Given a collection of scored PSMs, produce a&nbsp;list
of proteins or peptides ranked by a quantification score. Spectral-counts
supports three types of quantification: Normalized Spectral Abundance
Factor (NSAF), Normalized Spectral Index (SI<sub>N</sub>) and 
Exponentially Modified Protein Abundance Index (emPAI). The
NSAF method is from a 
<a href="http://www.ncbi.nlm.nih.gov/pubmed/17138671">publication
by Paoletti et al. (2006)</a>. The SI<sub>N</sub> method is from the 
<a href="http://www.nature.com/nbt/journal/v28/n1/abs/nbt.1592.html">Griffin
et al. (2010) paper</a>. The emPAI method was first described in
<a href="http://www.mcponline.org/content/4/9/1265">Ishihama et al
  (2005)</a>. 
The quantification methods are defined below:</p> 
<b>Protein Quantification </b>
<ol>
<li>
  <p>For each protein in a given database, the NSAF score is:</p>
  <p><img alt="" src="nsaf_prot_equation_a.png"></p>
<div>where:</div>
<ul>
<li>N is protein index</li>
<li>S<sub>N</sub> is the number spectra matched to protein index</li>
<li>L<sub>N</sub> is the length of protein N </li>
<li>n is the total number of proteins in the input database</li>
</ul>
  <p>With the distribution factor of shared spectra matched, the NSAF score is:</p>
  <p><img alt="" src="nsaf_prot_equation_b.png"></p>
<div>where:</div>
<ul>
<li>N is the protein index</li>
<li>uSpc<sub>N</sub> is the unique number spectra matched to the protein index</li>
<li>sSpc<sub>N</sub> is the shared number spectra matched to the protein index</li>
<li>uL<sub>N</sub> is the unique length of protein N</li>
<li>sL<sub>N</sub> is the shared length of protein N</li>
<li>n is the total number of proteins in the input database</li>
<li>d is the distributing factor of protein N, given by</li>
<p><img alt="" src="d.png"></p>
</ul>
</li>
<li>
  <p>For each protein in a given database, the SI<sub>N</sub> score is:</p>
  <p><img alt="" src="sin_prot_equation.png"></p>
  <div>where:</div>
  <ul>
    <li>N is protein index</li>
    <li>p<sub>n</sub> is the number of unique peptides in protein N</li>
    <li>s<sub>j</sub> is the number of spectra assigned to peptide j</li>
    <li>i<sub>k</sub> is the total fragment ion intensity of spectrum k</li>
    <li>L<sub>N</sub> is the length of protein N</li>
  </ul>
</li>
<li>
  <p>For each protein in a given database, the emPAI score is:</p>
  <p><img alt="" src="quant_empai_1.gif"></p>
<div>where:</div>
<ul>
<li>N<sub>observed</sub> is the number of experimentally observed
  peptides with scores above a specified threshold.</li>
<li>N<sub>obervable</sub> is the calculated number of observable
  peptides for the protein given the search constraints.</li>
</ul></li>
</ol>
</div>

<div> <u>Peptide Quantification</u>
  <ol>
<li><p>For each peptide in a given database, the NSAF score is:</p>
<p><img alt="" src="nsaf_pep_equation_a.png"></p>
<div>where:</div>
<ul>
<li>N is the peptide index</li>
<li>S<sub>N</sub> is the number spectra matched to peptide N</li>
<li>L<sub>N</sub> is the length of peptide N </li>
<li>n is the total number of peptides in the input database</li>
</ul>
  <p>With the distribution factor of shared spectra matched, the NSAF score is:</p>
  <p><img alt="" src="nsaf_pep_equation_b.png"></p>
<div>where:</div>
<ul>
<li>N is the peptide index</li>
<li>uSpc<sub>N</sub> is the unique number spectra matched to the peptide index</li>
<li>sSpc<sub>N</sub> is the shared number spectra matched to the peptide index</li>
<li>uL<sub>N</sub> is the unique length of peptide N</li>
<li>sL<sub>N</sub> is the shared length of peptide N</li>
<li>n is the total number of peptides in the input database</li>
<li>d is the distributing factor of peptide N, given by</li>
<p><img alt="" src="d.png"></p>
</ul>
</li>

<li>

<p>For each peptide in a given database, the SI<sub>N</sub> score is:</p>
<p><img alt="" src="sin_pep_equation.png"></p>
<div>where:</div>
<ul>
<li>N is the peptide index</li>
<li>s<sub>N</sub> is the number of spectra assigned to peptide N</li>
<li>i<sub>k</sub> is the total fragment ion intensity of spectrum k</li>
<li>L<sub>N</sub> is the length of peptide N</li>
</ul>
</li>
</ol>
</div>
</div>


</blockquote>
<p>
<b>Input:</b></p>
<ul>

<li>
<code>&lt;input PSMs&gt;</code>&ndash;
A tab delimited text file produced by a <code>crux</code> post-search
command, for example <code>percolator.target.txt</code>
or <code>qranker.target.txt</code>.</li>

<li><code>&lt;protein database&gt;</code>&ndash; 
The name of the file in fasta format or the directory containing the
protein index from which to retrieve proteins and peptides.</li>
</ul>

<b>Output:</b>
<ul>

<p>
The program writes one file to the folder <code>crux-output</code> by
default.  The name of the output folder can be set by the user using
the <code>--output-dir</code> option. The following files will be
created:</p>

<li>
<code>spectral-count.target.txt</code>: a tab-delimited text file
containing the protein IDs and their corresponding scores, in sorted
order.</li>

<li><code>spectral-count.log.txt</code>: All messages written to
standard error.</li>

</ul>

<b>Options:</b>
<br>
<ul>

<li>
<code>--measure &lt;NSAF|SIN|EMPAI&gt;</code> &ndash;
Type of analysis to make on match results: (NSAF | SIN |
EMPAI). Default = NSAF. 
</li>

<li>
<code>--quant-level &lt;protein|peptide&gt;</code> &ndash; 
Quantification at protein or peptide level. Methods described under 
Description. Default = protein.
</li>

<li>
<code>--parsimony &lt;none|simple|greedy&gt;</code> &ndash; 
Perform a parsimony analysis on the proteins, and report a "parsimony
rank" column in the output file.  This column contains integers
indicating the protein's rank in a list sorted by spectral counts.  If
the parsimony analysis results in two proteins being merged, then
their parsimony rank is the same.  In such a case, the rank is
assigned based on the largest spectral count of any protein in the
merged meta-protein.  The "simple" parsimony algorithm only merges two
proteins A and B if the peptides identified in protein A are the same
as or a subset of the peptides identified in protein B.  The "greedy"
parsimony algorithm does additional merging, using the peptide
q-values to greedily assign each peptide to a single protein. Default
= none.</li> 

<li>
<code>--threshold &lt;double&gt; </code> &ndash; 
Only consider PSMs with a q-value lower than this threshold.  The
q-value may be in the file's "percolator q-value" column, "q-ranker
q-value" column or "decoy q-value (xcorr)" column. Default = 0.01. 
</li>

<li>
<code>--fileroot &lt;string&gt;</code> &ndash;
The <code>fileroot</code> string will be added as a prefix to all
output file names. Default = none.
</li>

<li>
<code>--input-MS2 &lt;string&gt;</code> &ndash;
MS2 file corresponding to the PSM file. Required to measure the
SIN. Ignored for NSAF and EMPAI.
</li>

<li>
<code>--output-dir &lt;filename&gt;</code> &ndash;
The name of the directory where output files will be created.
Default = crux-output.
</li>

<li>
<code>--unique-mapping &lt;unique-mapping&gt;</code> &ndash;
Ignore peptides with mappings to multiple proteins (T,F). Default (F)
</li>

<li>
<code>--overwrite &lt;T|F&gt;</code> &ndash; 
Replace existing files if true (T) or fail when trying to overwrite a
file if false (F). Default = F.</li> 

<li>
<code>--parameter-file &lt;filename&gt;</code> &ndash; 
A file containing command line or additional parameters.  See
the <a href=parameter-file.html>parameter documentation</a> page for
details.</li>

</ul>
<hr>

<p><a href="crux.html">Crux home</a></p>

</blockquote>
</body>
</html>
