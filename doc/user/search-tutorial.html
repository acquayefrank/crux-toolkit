<html>
<head>
<title>Crux: Search</title>

<link rel="stylesheet" href="crux.css" type="text/css">

</head>

<body>
<blockquote>

<div id="main">

<h1>Running a Simple Search</h1>

<p>Now that you have your environment <a
href="start-tutorial.html">set up</a> and the two input files 
in your working directory, you can conduct the search. The search
process compares each spectrum in <span class=file>demo.ms2</span> to 
peptides (subsequences of the proteins) in fasta files provided in a dirctory, <span class=file>yeast-index/</span>.  For each peptide a theoretical
spectrum is created based on the predicted fragmentation of the
peptide.  The theoretical spectra are each compared to the
experimental spectrum (in the ms2 file) and scored based on their
similarity.  These scores are reported in the output.  To conduct the
search, we have to run <code>create-index</code> command and then use the 
<code>search-for-mathes</code> command.</p>
<ol>
<li>
<div class=code>
<code>$ crux create-index small-yeast.fasta yeast-index </code>
</div>
<p>While generating an index of all of its peptides , you will see output like this</p>

<pre>
INFO: Beginning create-index.
INFO: Creating index from fasta file 'small-yeast.fasta'
INFO: Total proteins found: 56
</pre>
<p>When the creating index  has completed, it will print: </p>
<pre>
INFO: Finished crux create-index.

</pre>
</li>

<p>
Now, you can run this command: </p>
<div class=code>
<li><code>$ crux search-for-matches  --compute-sp T demo.ms2 yeast-index/</code>
</div>

<p>While the search is running, you will see output like this
</p>

<pre>
INFO: Reading in ms2 file demo.ms2
INFO: Preparing protein index yeast-index/
INFO: Created 1 peptide mods, keeping 1 with 255 or fewer aa mods
INFO: Searching spectrum number 18 (3+), search number 10 of 166, 6% complete

</pre>
</li>

<p>When the search has completed, it will print</p>
<pre>
INFO: crux-search-for-matches finished
</pre>

<p>A new directory, <span class=file>crux-output</span>, will have been created. 
Looking at the contents of the directory, you will see six new files
containing the search results: 
<ul>
<li>search.target.txt &ndash; search results in <a href="txt-format.html">tab-delimited format</a>.</li>
<li>search.decoy.txt &ndash; search results from a decoy database in <a href="txt-format.html">tab-delimited format</a>.</li>
<li>search.target.pep.xml &ndash; search results in pepXML format.</li>
<li>search.decoy.pep.xml &ndash; search results from a decoy database in pepXML format.</li>
<li>search.params.txt &ndash; parameters used in the search.</li>
<li>search.log.txt &ndash; log file for the search.</li>
</ul>

</p>
</li>

<p>The final step is to analyze our search results.  Each spectrum has
been compared to many peptides and we would like to return only the
best match(es) for each spectrum.  We also expect that
some fraction of the spectra will not be identifiable as peptides (due
to chemical noise, multiple peptides co-eluting, poor fragmentation,
etc.).  The analysis step filters out those spectra and returns only the
high-quality peptide-spectrum matches. If you run search-for-matches command with a fasta file, please 
look <a href="known-issues.html">issue 1</a> before running the bellow command.
</p>
<li>
<div class=code><code>
$ crux q-ranker --output-dir qranker-output --separate-searches ./crux-output/search.decoy.txt demo.ms2 crux-output/search.target.txt</code>
</div>

<p>While the analysis is running, you will see output like this
</p>

<pre>
INFO: Beginning q-ranker.
INFO: delmited source: ./crux-output/search.target.txt
INFO: ms2 source: demo.ms2
</pre>

<p>When the analysis is complete it will print </p>
<pre>
INFO: Finished crux q-ranker.

</pre>

<p>There will be five new files in the <span class=file>qranker-output</span> directory.
<ul>
<li>q-ranker.target.psms.txt &ndash; q-ranker results in <a href="txt-format.html">tab-delimited format</a>.</li>
<li>q-ranker.psms.at.fdr.thresholds.txt &ndash; number of psms accepted at a particular q-value threshold</li>
<li>q-ranker.params.txt &ndash; parameters used for running q-ranker.</li>
<li>q-ranker_output.xml &ndash; q-ranker results in pepXML format.</li>
<li>q-ranker.log.txt &ndash; q-ranker log file.</li>
</ul>
</p>

<p>

The q-ranker.target.psms.txt file will look like this:<br>
<pre>
scan    charge  q-ranker q-value        q-ranker score  q-ranker PEP    spectrum precursor m/z  spectrum neutral mass   peptide mass    delta_cn        sp score        sp rank xcorr score     xcorr rank      b/y ions matched    b/y ions total  matches/spectrum        sequence        cleavage type   protein id      flanking aa     filename
53      2       0       3.14519 0.04186 745.749 1489.48 1489.73 0.816319        2953.36 1       4.28817 1       21      24      4       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
62      2       0       3.14476 0.0418757       745.859 1489.7  1489.73 0.91249 2727.86 1       4.17594 1       21      24      3       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
131     2       0       3.14439 0.0418892       745.849 1489.68 1489.73 0.911082        2887.16 1       3.96851 1       21      24      3       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
11      2       0       3.14323 0.0419318       745.269 1488.52 1489.73 0.775185        2777.4  1       3.68443 1       21      24      5       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
85      3       0       3.14293 0.0419427       497.618 1489.83 1489.73 0.890992        2292.95 1       4.88676 1       27      48      3       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
77      2       0       3.14105 0.0420117       745.429 1488.84 1489.73 0.807153        2585.78 1       3.61218 1       21      24      4       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
92      3       0       3.13973 0.0420601       497.278 1488.81 1489.73 0.855949        2126.37 1       4.52471 1       25      48      4       NFLETVELQVGLK   trypsin-full-digest     YGL135W(27)     RN      ./crux-output/search.target.txt
118     3       0       3.13972 0.0420606       1031.94 3092.79 3095.24 0.928041        1896.11 1       4.5782  1       43      108     3       ELESAAYDHAEPVQPEDAPQDIANDELK    trypsin-full-digest     YGL009C(500)    KD ./crux-output/search.target.txt
156     3       0       3.13791 0.0421271       1032.44 3094.29 3095.24 0.957132        1779.63 1       4.2332  1       41      108     2       ELESAAYDHAEPVQPEDAPQDIANDELK    trypsin-full-digest     YGL009C(500)    KD ./crux-output/search.target.txt
</pre>

Here, the third column contains the q-ranker q-value assigned to each
PSM, and the corresponding posterior error probabilities are in fifth column.
The remainder of the columns are described <a href="txt-format.html">here</a>.
</p>
</li>
</ol>
</div><!--end main-->

<hr></hr>

<a href="crux.html">Crux home</a>
<p align="right"> <a href="index-tutorial.html">Next: Creating a peptide index</a>

</blockquote>
</body>
</html>
