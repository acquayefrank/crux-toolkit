
<html>
<head>
<title>Crux: Search</title>

<link rel="stylesheet" href="crux.css" type="text/css">

</head>

<body>
<blockquote>

<div id="main">

<h1>Running a Simple Analysis Using Barista</h1>

<p>
Now that you have your environment <a href="start-tutorial.html">set
up</a>, the two input files in your working directory, and you have
run a search with tide  <a href="search-tutorial.html">tide-search</a> 
finished, you can use Barista to rank the PSMs, peptides, and proteins. Barista requires
three inputs: a set of MS2 spectra found in <span class=file>demo.ms2</span>,
a target database <span class=file>tide-search.target.txt</span>,
a decoy database <span class=file>tide-search.decoy.txt</span>, and 
the original protein database <span class=file>small-yeast.fasta</span>.
The Barista searches may be carried out on a concatenated PSM database,
but we will use the <code>--separate-searches</code> option and separate
target and decoy databases, because we earlier used the <code>crux tide-index</code> 
command with <code>--concat F</code>. Barista produces as output three ranked lists of proteins, 
peptides and PSMs, based on how likely the proteins and peptides are to be 
present in the sample and how likely the PSMs are to be correct. 
</p>

<div class=code>
Create a concatonated database file (any file name will work).
<code>$ cat small-yeast.fasta ./tide-index.decoy.fasta > concat.fasta</code>
Use the separate searches option to allow barista to compare the decoy and target PSMs with the decoy and target databases.
<code>$ crux barista --separate-searches crux-output/tide-search.decoy.txt concat.fasta demo.ms2 crux-output/tide-search.target.txt</code>

</div>

<p>
While Barista is running, you will see output like this:</p>

<pre>
INFO: Beginning barista.
Existing files will be overwritten.
INFO: CPU: [LOCAL CPU INFO]
INFO: [DATE INFO]
INFO: database source: concat.fasta
INFO: sqt source: crux-output/tide-search.target.txt
INFO: ms2 source: demo.ms2
INFO: output_directory: crux-output
INFO: enzyme: trypsin
INFO: decoy prefix: decoy_
INFO: digesting database concat.fasta
INFO: parsing files:
INFO: reading file demo.ms2
INFO: parsing file crux-output/tide-search.target.txt
INFO: PSM number 0
INFO: parsing file crux-output/tide-search.decoy.txt
INFO: Number of spectra: 332
INFO: Number of PSMs: total 332 positives 166 negatives 166
INFO: Number of peptides: total 188 positives 88 negatives 100
INFO: Number of proteins: total 89 positives 41 negatives 48
INFO: loading and normalizing data
INFO: trainset size 89
INFO: q&lt;0.01: max non-parsimonious so far 9
INFO: q&lt;0.01: max non-parsimonious so far 13
INFO: q&lt;0.01: max non-parsimonious so far 15
INFO: q&lt;0.01: max non-parsimonious so far 17
INFO: q&lt;0.01: max non-parsimonious so far 19
INFO: finished training, making parsimonious protein set
number of meta groups 89
number of subset groups 0
INFO: total proteins parsimonious at q&lt;0.01: 19
INFO: peptides at q&lt;0.01: 21
INFO: psms at q&lt;0.01: 65
INFO: Elapsed time: 16.7 s
INFO: Finished crux barista.
INFO: Return Code:0
</pre>

<p>
The <span class=file>crux-output</span> directory now contains four new files
containing the search results: 
<ul>
  <li><code>barista.xml</code> &ndash; an <a href="barista-xml-format.html">XML file</a> that contains information about proteins, subset proteins, peptides, and PSMs,</li>
  <li><code>barista.target.proteins.txt</code> &ndash; a <a href="txt-format.html">tab-delimited file</a> containing a ranked list of groups of indistinguishable target proteins with associated Barista scores and q-values, and with peptides that contributed to the identification of the protein group,</li>
  <li><code>barista.target.subset-proteins.txt</code> &ndash; a <a href="txt-format.html">tab-delimited file</a> containing groups of indistinguishable proteins.</li>
  <li><code>barista.target.peptides.txt</code> &ndash; a <a href="txt-format.html">tab-delimited file</a> containing a ranked list of target peptides with the associated Barista scores and q-values,</li>
  <li><code>barista.target.psm.txt</code> &ndash; a <a href="txt-format.html">tab-delimited file format</a> containing a ranked list of target peptide-spectrum matches with the associated Barista scores and q-values,</li>
  <li><code>barista.log.txt</code> &ndash; a file where the program reports its progress, and</li>
  <li><code>barista.params.txt</code> &ndash; a file with the values of all the options given to the current run.</li>
</ul>
<ul>

<p>
The beginning of the barista.target.psms.txt file will look like
this:</p>

<TABLE border cellspacing=0>
<TR>
<TD>scan </TD> <TD>charge </TD> <TD>barista q-value </TD> <TD>barista score </TD> <TD>barista PEP </TD> <TD>spectrum precursor m/z </TD> <TD>spectrum neutral mass </TD> <TD>peptide mass </TD> <TD>delta_cn </TD> <TD>sp score </TD> <TD>sp rank </TD> <TD>xcorr score </TD> <TD>xcorr rank </TD> <TD>b/y ions matched </TD> <TD>b/y ions total </TD> <TD>matches/spectrum </TD> <TD>sequence </TD> <TD>cleavage type </TD> <TD>protein id </TD> <TD>flanking aa </TD> <TD>filename</TD> </TR>
<TR>
<TD> 24 </TD> <TD>3 </TD> <TD>0 </TD> <TD>29.3699 </TD> <TD>1.44172e-14 </TD> <TD>830.617 </TD> <TD>2488.83 </TD> <TD>2489.23 </TD> <TD>0.204993 </TD> <TD>26.8304 </TD> <TD>1 </TD> <TD>0.0115347 </TD> <TD>1 </TD> <TD>13 </TD> <TD>84 </TD> <TD>2 </TD> <TD>AAGQLDQLVEDYINDELEIVSR </TD> <TD>trypsin-full-digest </TD> <TD>YBR115C(350) </TD> <TD>RI </TD> <TD>crux-output/tide-search.target.txt</TD> </TR>
<TR>
<TD>19 </TD> <TD>2 </TD> <TD>0 </TD> <TD>24.3944 </TD> <TD>3.97239e-12 </TD> <TD>604.287 </TD> <TD>1206.56 </TD> <TD>1206.64 </TD> <TD>0.130336 </TD> <TD>4.47427 </TD> <TD>2 </TD> <TD>-0.00908398 </TD> <TD>1 </TD> <TD>2 </TD> <TD>18 </TD> <TD>2 </TD> <TD>DTLKPMAIYR </TD> <TD>trypsin-full-digest </TD> <TD>YLR371W(1245) </TD> <TD>RV </TD> <TD>crux-output/tide-search.target.txt</TD> </TR>
<TR>
<TD>11 </TD> <TD>2 </TD> <TD>0 </TD> <TD>22.4299 </TD> <TD>3.65181e-11 </TD> <TD>745.267 </TD> <TD>1488.52 </TD> <TD>1488.82 </TD> <TD>0.822851 </TD> <TD>2816.6 </TD> <TD>1 </TD> <TD>4.44855 </TD> <TD>1 </TD> <TD>21 </TD> <TD>24 </TD> <TD>4 </TD> <TD>NFLETVELQVGLK </TD> <TD>trypsin-full-digest </TD> <TD>YGL135W(27) </TD> <TD>RN </TD> <TD>crux-output/tide-search.target.txt</TD> </TR>
<TR>
<TD>77 </TD> <TD>2 </TD> <TD>0 </TD> <TD>21.6404 </TD> <TD>8.90675e-11 </TD> <TD>745.427 </TD> <TD>1488.84 </TD> <TD>1488.82 </TD> <TD>0.956509 </TD> <TD>2695.96 </TD> <TD>1 </TD> <TD>4.08086 </TD> <TD>1 </TD> <TD>21 </TD> <TD>24 </TD> <TD>3 </TD> <TD>NFLETVELQVGLK </TD> <TD>trypsin-full-digest </TD> <TD>YGL135W(27) </TD> <TD>RN </TD> <TD>crux-output/tide-search.target.txt</TD> </TR>
<TR>
<TD>53 </TD> <TD>2 </TD> <TD>0 </TD> <TD>19.9179 </TD> <TD>6.23022e-10 </TD> <TD>745.747 </TD> <TD>1489.48 </TD> <TD>1488.82 </TD> <TD>0.935648 </TD> <TD>2797.78 </TD> <TD>1 </TD> <TD>4.39828 </TD> <TD>1 </TD> <TD>21 </TD> <TD>24 </TD> <TD>3 </TD> <TD>NFLETVELQVGLK </TD> <TD>trypsin-full-digest </TD> <TD>YGL135W(27) </TD> <TD>RN </TD> <TD>crux-output/tide-search.target.txt </TD>
</TR>
</TABLE>

<p>
In this output, the PSMs are ranked by "barista score," with higher
scores indicating a higher quality match. The associated statistical
confidence estimate is reported as a "barista q-value," interpreted
as the minimal false discovery rate threshold at which this match is
deemed significant.  In the list above, all of the matches have
q-values of 0, meaning that they are highly significant.
The meanings of the remaining columns are
described <a href="txt-format.html">here</a>.</p>

</div><!--end main-->

<hr></hr>

<p>
<!-- TODO: change the next link-->
<a href="customize-tutorial.html">Next: Creating a peptide index</a></p>

<p>
<a href="crux.html">Crux home</a></p>

</blockquote>
</body>
</html>
