<html>
<title>Crux calibration tests</title>
<body>

<h1>Crux calibration tests</h1>

<p>
The crux search-for-matches tool can report statistical confidence
measures in the form of p-values.  In this test, we measure the extent
to which these p-values are uniformly distributed for scores drawn
according to the null hypothesis.  We use as a null model scores
generated by searching real spectra against synthetic (shuffled)
protein sequences.  Uniformity of the p-values is visualized by
plotting a histogram and a quantile-quantile (QQ) plot of the p-value
distribution.  A perfect histogram will be uniform in the interval
[0,1].  A perfect QQ will follow the line y=x.  We plot the QQ plot on
a log scale, and include lines corresponding to y=2x and y=0.5x.
Ideally, the statistic will stay within these boundaries over multiple
orders of magnitude.  The plots are produced both for the targets
(which are shuffled protein sequences) and the decoys (which are
re-shuffled peptides from within the shuffled proteins).</p>

<table>
<tr>
<td><img src="target.histogram.expected.png"></td>
<td><img src="target.histogram.png"></td>
</tr>
<tr>
<td><img src="decoy.histogram.expected.png"></td>
<td><img src="decoy.histogram.png"></td>
</tr>
<tr>
<td><img src="target.qq.expected.png"></td>
<td><img src="target.qq.png"></td>
</tr>
<tr>
<td><img src="decoy.qq.expected.png"></td>
<td><img src="decoy.qq.png"></td>
</tr>
<td><center><b>Expected results</b></center></td>
<td><center><b>Observed results</b></center></td>
</tr>
</table>

<p>
N.B. As of 30 November 2012, the calibration test is not working.
Indeed, as far as I can tell, it never worked, even when I initially
created it in August 2010.  I therefore modified the test to also
produce a histogram of decoy p-values prior to the Sidak
correction:</p>

<center>
<img src="decoy.png">
</center>


<p>
WSN<br>
30 November 2012</p>

</body>
</html>

